<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="SoulTide - Find Your Nigerian Soulmate">
  <title>SoulTide - Find Your Soulmate</title>
  <script src="https://js.paystack.co/v1/inline.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/zego-express-engine-webrtc@3.0.0/dist/zego-express-engine-webrtc.min.js"></script>
  <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
  <script type='text/javascript' src='//pl28032598.effectivegatecpm.com/d5/f5/69/d5f569c5729fc996b2456219766c47a3.js'></script>
  <style>
    :root {
      --primary: #ff4d8d;
      --secondary: #6a11cb;
      --dark: #1a1a2e;
      --light: #f8f9fa;
      --success: #28a745;
      --warning: #ffc107;
      --danger: #dc3545;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, var(--secondary), var(--primary));
      min-height: 100vh;
      color: var(--dark);
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 0;
      color: white;
    }
    
    .logo {
      font-size: 28px;
      font-weight: 700;
      display: flex;
      align-items: center;
    }
    
    .logo i {
      margin-right: 10px;
      color: var(--warning);
    }
    
    .auth-buttons button {
      background: transparent;
      border: 2px solid white;
      color: white;
      padding: 8px 20px;
      border-radius: 20px;
      margin-left: 10px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .auth-buttons button:hover {
      background: white;
      color: var(--primary);
    }
    
    /* Page Sections */
    .page {
      display: none;
    }
    
    .page.active {
      display: block;
    }
    
    /* Auth Styles */
    .auth-container {
      background: white;
      border-radius: 20px;
      padding: 40px;
      max-width: 400px;
      margin: 50px auto;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    
    .auth-tabs {
      display: flex;
      margin-bottom: 30px;
      border-radius: 10px;
      overflow: hidden;
      background: #f8f9fa;
    }
    
    .auth-tab {
      flex: 1;
      padding: 15px;
      border: none;
      background: transparent;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .auth-tab.active {
      background: var(--primary);
      color: white;
    }
    
    .auth-form {
      display: none;
    }
    
    .auth-form.active {
      display: block;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--dark);
    }
    
    .form-group input, .form-group select, .form-group textarea {
      width: 100%;
      padding: 14px;
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 16px;
    }
    
    .btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 14px;
      border-radius: 10px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
    }
    
    .btn:hover {
      opacity: 0.9;
    }
    
    .btn-secondary {
      background: #f0f0f0;
      color: var(--dark);
    }
    
    .error-message {
      background: #ffebee;
      color: #c62828;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
      text-align: center;
      display: none;
    }
    
    .success-message {
      background: #e8f5e9;
      color: #2e7d32;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
      text-align: center;
      display: none;
    }
    
    /* Profile Setup */
    .profile-setup-container {
      background: white;
      border-radius: 20px;
      padding: 40px;
      max-width: 600px;
      margin: 30px auto;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    
    .photo-upload {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .photo-placeholder {
      width: 100px;
      height: 100px;
      border: 2px dashed #ddd;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      background-color: #f9f9f9;
      position: relative;
      overflow: hidden;
    }
    
    .photo-placeholder img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .photo-placeholder:hover {
      border-color: var(--primary);
    }
    
    .photo-upload-input {
      display: none;
    }
    
    .interests-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .interest-tag {
      background: #f0f0f0;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .interest-tag.selected {
      background: var(--primary);
      color: white;
    }
    
    /* Swiping Page */
    .swipe-container {
      max-width: 400px;
      margin: 20px auto;
      position: relative;
      height: 600px;
    }
    
    .profile-card {
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      overflow: hidden;
      position: absolute;
      width: 100%;
      height: 100%;
      transition: transform 0.3s;
    }
    
    .profile-image {
      height: 70%;
      background-size: cover;
      background-position: center;
    }
    
    .profile-info {
      padding: 20px;
    }
    
    .profile-name {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 5px;
    }
    
    .profile-age {
      color: #777;
      margin-bottom: 10px;
    }
    
    .profile-bio {
      margin-bottom: 15px;
      color: #666;
    }
    
    .profile-interests {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    
    .swipe-actions {
      display: flex;
      justify-content: space-around;
      padding: 20px;
      position: absolute;
      bottom: 0;
      width: 100%;
    }
    
    .swipe-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      border: none;
      transition: transform 0.2s ease;
    }
    
    .swipe-btn:hover {
      transform: scale(1.1);
    }
    
    .pass-btn {
      background: white;
      color: var(--danger);
    }
    
    .like-btn {
      background: var(--success);
      color: white;
    }
    
    /* Profile Detail Page */
    .profile-detail-container {
      background: white;
      border-radius: 20px;
      padding: 30px;
      max-width: 800px;
      margin: 30px auto;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    
    .profile-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .profile-pic {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      object-fit: cover;
      border: 5px solid var(--primary);
      margin: 0 auto 20px;
    }
    
    .profile-details {
      margin: 30px 0;
    }
    
    .detail-item {
      display: flex;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
    }
    
    .detail-label {
      font-weight: 600;
      width: 150px;
      color: var(--primary);
    }
    
    .detail-value {
      flex: 1;
    }
    
    .action-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
    }
    
    .action-btn {
      padding: 12px 25px;
      border: none;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
    }
    
    .action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    
    .message-btn {
      background: var(--primary);
      color: white;
    }
    
    .voice-call-btn {
      background: var(--success);
      color: white;
    }
    
    .video-call-btn {
      background: var(--secondary);
      color: white;
    }
    
    /* Subscription Page */
    .subscription-container {
      background: white;
      border-radius: 20px;
      padding: 30px;
      margin: 30px auto;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    
    .subscription-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .subscription-plans {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
    }
    
    .plan-card {
      border: 2px solid #eee;
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .plan-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    
    .plan-card.featured {
      border-color: var(--primary);
      position: relative;
    }
    
    .plan-card.featured::before {
      content: 'POPULAR';
      position: absolute;
      top: -10px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--primary);
      color: white;
      padding: 5px 15px;
      border-radius: 15px;
      font-size: 12px;
      font-weight: 600;
    }
    
    .plan-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 15px;
      color: var(--primary);
    }
    
    .plan-price {
      font-size: 28px;
      font-weight: 700;
      margin: 15px 0;
      color: var(--dark);
    }
    
    .plan-features {
      text-align: left;
      margin: 20px 0;
    }
    
    .feature {
      padding: 8px 0;
      display: flex;
      align-items: center;
    }
    
    .feature i {
      color: var(--success);
      margin-right: 10px;
    }
    
    .subscribe-btn {
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 25px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 15px;
      transition: opacity 0.3s ease;
    }
    
    .subscribe-btn:hover {
      opacity: 0.9;
    }
    
    /* Payment Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }
    
    .modal-content {
      background: white;
      border-radius: 20px;
      width: 90%;
      max-width: 500px;
      padding: 30px;
      position: relative;
    }
    
    .close-modal {
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 24px;
      cursor: pointer;
      color: #999;
    }
    
    /* Call UI */
    #call-ui {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.9);
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      color: white;
    }
    
    #call-video {
      width: 80%;
      max-width: 800px;
      height: 60%;
      background: black;
      margin-bottom: 20px;
      border-radius: 10px;
      overflow: hidden;
    }
    
    #remote-video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    #call-controls {
      display: flex;
      gap: 20px;
    }
    
    .call-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: none;
      font-size: 24px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .hangup-btn {
      background: #f44336;
      color: white;
    }
    
    .answer-btn {
      background: #4caf50;
      color: white;
    }
    
    .reject-btn {
      background: #9e9e9e;
      color: white;
    }
    
    #call-status {
      margin-bottom: 20px;
      font-size: 18px;
    }
    
    /* Chat UI */
    .chat-container {
      background: white;
      border-radius: 20px;
      padding: 20px;
      max-width: 800px;
      margin: 30px auto;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      height: 500px;
      display: flex;
      flex-direction: column;
    }
    
    .chat-header {
      display: flex;
      align-items: center;
      padding-bottom: 15px;
      border-bottom: 1px solid #eee;
      margin-bottom: 15px;
    }
    
    .chat-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background-size: cover;
      background-position: center;
      margin-right: 15px;
    }
    
    .chat-messages {
      flex: 1;
      overflow-y: auto;
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .message {
      max-width: 70%;
      padding: 12px 16px;
      border-radius: 20px;
      word-wrap: break-word;
    }
    
    .message.sent {
      align-self: flex-end;
      background: var(--primary);
      color: white;
    }
    
    .message.received {
      align-self: flex-start;
      background: #f0f0f0;
      color: var(--dark);
    }
    
    .chat-input-container {
      display: flex;
      gap: 10px;
      padding-top: 15px;
      border-top: 1px solid #eee;
    }
    
    .chat-input {
      flex: 1;
      padding: 12px 16px;
      border: 1px solid #ddd;
      border-radius: 25px;
      font-size: 16px;
    }
    
    .send-btn {
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    
    /* Usage Counter */
    .usage-counter {
      background: white;
      border-radius: 15px;
      padding: 20px;
      margin: 20px auto;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      max-width: 400px;
    }
    
    .usage-item {
      margin: 10px 0;
      font-size: 16px;
    }
    
    .usage-warning {
      color: var(--danger);
      font-weight: 600;
      margin-top: 10px;
    }
    
    /* Notification */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 25px;
      border-radius: 10px;
      color: white;
      font-weight: 600;
      z-index: 1001;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .notification.success {
      background-color: var(--success);
    }
    
    .notification.error {
      background-color: var(--danger);
    }
    
    .notification.show {
      opacity: 1;
    }
    
    /* Loading Spinner */
    .spinner {
      border: 4px solid rgba(0, 0, 0, 0.1);
      border-left-color: var(--primary);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }
      
      .profile-pic {
        width: 150px;
        height: 150px;
      }
      
      .action-buttons {
        flex-direction: column;
        gap: 10px;
      }
      
      .action-btn {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <!-- Call UI -->
  <div id="call-ui">
    <div id="call-status">Incoming call...</div>
    <div id="call-video">
      <video id="remote-video" autoplay playsinline></video>
    </div>
    <div id="call-controls">
      <button class="call-btn hangup-btn" onclick="endCall()">ðŸ“ž</button>
      <button class="call-btn answer-btn" id="answer-btn" onclick="answerCall()" style="display:none;">âœ“</button>
      <button class="call-btn reject-btn" id="reject-btn" onclick="rejectCall()" style="display:none;">âœ•</button>
    </div>
  </div>

  <!-- Payment Modal -->
  <div id="paymentModal" class="modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal('paymentModal')">&times;</span>
      <h2 style="text-align:center; margin-bottom:20px;">Complete Your Subscription</h2>
      <div id="payment-details">
        <p>Plan: <span id="selected-plan"></span></p>
        <p>Amount: <span id="selected-amount"></span></p>
      </div>
      <button class="btn" onclick="processPayment()">Pay with ATM Card</button>
    </div>
  </div>

  <div class="container">
    <!-- Header -->
    <header>
      <div class="logo">
        <i class="fas fa-heart"></i>
        SoulTide
      </div>
      <div class="auth-buttons" id="header-buttons" style="display: none;">
        <button onclick="showPage('profile-setup')">Profile</button>
        <button onclick="showPage('subscription')">Subscribe</button>
        <button onclick="logout()">Logout</button>
      </div>
    </header>

    <!-- Auth Page -->
    <div id="auth-page" class="page active">
      <div class="auth-container">
        <h2 style="text-align: center; margin-bottom: 30px; color: var(--dark);">Welcome to SoulTide</h2>
        
        <div class="auth-tabs">
          <button class="auth-tab active" onclick="showAuthTab('login')">Login</button>
          <button class="auth-tab" onclick="showAuthTab('signup')">Sign Up</button>
        </div>

        <div id="login-form" class="auth-form active">
          <div id="login-error" class="error-message"></div>
          <div id="login-success" class="success-message"></div>
          <div class="form-group">
            <label for="login-email">Email</label>
            <input type="email" id="login-email" placeholder="Enter your email">
          </div>
          <div class="form-group">
            <label for="login-password">Password</label>
            <input type="password" id="login-password" placeholder="Enter your password">
          </div>
          <button class="btn" onclick="login()">Login</button>
        </div>

        <div id="signup-form" class="auth-form">
          <div id="signup-error" class="error-message"></div>
          <div id="signup-success" class="success-message"></div>
          <div class="form-group">
            <label for="signup-email">Email</label>
            <input type="email" id="signup-email" placeholder="Enter your email">
          </div>
          <div class="form-group">
            <label for="signup-password">Password</label>
            <input type="password" id="signup-password" placeholder="Create a password">
          </div>
          <div class="form-group">
            <label for="confirm-password">Confirm Password</label>
            <input type="password" id="confirm-password" placeholder="Confirm your password">
          </div>
          <button class="btn" onclick="signup()">Sign Up</button>
        </div>
      </div>
    </div>

    <!-- Profile Setup Page -->
    <div id="profile-setup-page" class="page">
      <div class="profile-setup-container">
        <h2 style="text-align: center; margin-bottom: 30px;">Complete Your Profile</h2>
        <div id="profile-error" class="error-message"></div>
        <div id="profile-success" class="success-message"></div>
        
        <div class="form-group">
          <label>Profile Photos</label>
          <div class="photo-upload">
            <div class="photo-placeholder" onclick="document.getElementById('photo-upload-1').click()">
              <span>+</span>
              <input type="file" id="photo-upload-1" class="photo-upload-input" accept="image/*" onchange="handlePhotoUpload(this, 1)">
            </div>
            <div class="photo-placeholder" onclick="document.getElementById('photo-upload-2').click()">
              <span>+</span>
              <input type="file" id="photo-upload-2" class="photo-upload-input" accept="image/*" onchange="handlePhotoUpload(this, 2)">
            </div>
            <div class="photo-placeholder" onclick="document.getElementById('photo-upload-3').click()">
              <span>+</span>
              <input type="file" id="photo-upload-3" class="photo-upload-input" accept="image/*" onchange="handlePhotoUpload(this, 3)">
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="profile-fullname">Full Name</label>
          <input type="text" id="profile-fullname" placeholder="Enter your full name">
        </div>

        <div class="form-group">
          <label for="profile-age">Age</label>
          <input type="number" id="profile-age" placeholder="Enter your age">
        </div>

        <div class="form-group">
          <label for="profile-gender">Gender</label>
          <select id="profile-gender">
            <option value="">Select Gender</option>
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="other">Other</option>
          </select>
        </div>

        <div class="form-group">
          <label for="profile-income">Monthly Income (â‚¦)</label>
          <select id="profile-income">
            <option value="">Select Income Range</option>
            <option value="0-500k">Below â‚¦500,000</option>
            <option value="500k-1.5M">â‚¦500,000 - â‚¦1.5M</option>
            <option value="1.5M-3M">â‚¦1.5M - â‚¦3M</option>
            <option value="3M-6M">â‚¦3M - â‚¦6M</option>
            <option value="6M-15M">â‚¦6M - â‚¦15M</option>
            <option value="15M+">Above â‚¦15M</option>
          </select>
        </div>

        <div class="form-group">
          <label for="profile-location">Location</label>
          <input type="text" id="profile-location" placeholder="Enter your location">
        </div>

        <div class="form-group">
          <label for="profile-bio">Bio</label>
          <textarea id="profile-bio" rows="4" placeholder="Tell others about yourself"></textarea>
        </div>

        <div class="form-group">
          <label>Interests</label>
          <div class="interests-container">
            <span class="interest-tag">Travel</span>
            <span class="interest-tag">Food</span>
            <span class="interest-tag">Music</span>
            <span class="interest-tag">Sports</span>
            <span class="interest-tag">Movies</span>
            <span class="interest-tag">Art</span>
            <span class="interest-tag">Fitness</span>
            <span class="interest-tag">Reading</span>
            <span class="interest-tag">Dancing</span>
            <span class="interest-tag">Cooking</span>
            <span class="interest-tag">Technology</span>
            <span class="interest-tag">Business</span>
          </div>
        </div>

        <button class="btn" onclick="saveProfile()">Save Profile & Start Matching</button>
        <button class="btn btn-secondary" onclick="skipProfileSetup()">Skip for Now</button>
      </div>
    </div>

    <!-- Swiping Page -->
    <div id="swipe-page" class="page">
      <h2 style="text-align: center; margin-bottom: 20px; color: white;">Discover People</h2>
      
      <!-- Usage Counter -->
      <div class="usage-counter">
        <h3>Your Usage</h3>
        <div class="usage-item">Messages: <span id="message-count">2</span>/2 remaining</div>
        <div class="usage-item">Voice Calls: <span id="voice-call-count">2</span>/2 remaining</div>
        <div class="usage-item">Video Calls: <span id="video-call-count">2</span>/2 remaining</div>
        <div class="usage-warning" id="usage-warning">Subscribe for unlimited access!</div>
      </div>

      <div class="swipe-container">
        <div id="profile-card" class="profile-card">
          <div class="spinner"></div>
          <p style="text-align: center; margin-top: 10px;">Loading profiles...</p>
        </div>
      </div>
    </div>

    <!-- Profile Detail Page -->
    <div id="profile-detail-page" class="page">
      <div class="profile-detail-container">
        <div class="profile-header">
          <img id="detail-profile-pic" src="" alt="Profile" class="profile-pic">
          <h1 id="detail-name" class="name-age"></h1>
          <p id="detail-location" class="location"></p>
        </div>
        
        <div class="profile-details">
          <div class="detail-item">
            <div class="detail-label">Age:</div>
            <div class="detail-value" id="detail-age"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Income:</div>
            <div class="detail-value" id="detail-income"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Occupation:</div>
            <div class="detail-value" id="detail-occupation"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Interests:</div>
            <div class="detail-value" id="detail-interests"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">About:</div>
            <div class="detail-value" id="detail-bio"></div>
          </div>
        </div>
        
        <div class="action-buttons">
          <button class="action-btn message-btn" onclick="startChat()">
            <i class="fas fa-comment"></i> Message
          </button>
          <button class="action-btn voice-call-btn" onclick="startVoiceCall()">
            <i class="fas fa-phone-alt"></i> Voice Call
          </button>
          <button class="action-btn video-call-btn" onclick="startVideoCall()">
            <i class="fas fa-video"></i> Video Call
          </button>
        </div>
      </div>
    </div>

    <!-- Chat Page -->
    <div id="chat-page" class="page">
      <div class="chat-container">
        <div class="chat-header">
          <div class="chat-avatar" id="chat-user-avatar"></div>
          <div>
            <h3 id="chat-user-name"></h3>
            <div id="typing-status"></div>
          </div>
        </div>
        <div class="chat-messages" id="chat-messages">
          <div class="no-messages">Start a conversation!</div>
        </div>
        <div class="chat-input-container">
          <input type="text" class="chat-input" id="chat-input" placeholder="Type a message..." maxlength="500">
          <button class="send-btn" onclick="sendChatMessage()">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Subscription Page -->
    <div id="subscription-page" class="page">
      <div class="subscription-container">
        <div class="subscription-header">
          <h2>Premium Access Plans</h2>
          <p>Unlock unlimited connections and premium features</p>
        </div>
        
        <div class="subscription-plans">
          <div class="plan-card">
            <div class="plan-title">Basic Access</div>
            <div class="plan-price">â‚¦1,500/month</div>
            <div class="plan-features">
              <div class="feature"><i class="fas fa-check"></i> Unlimited Swipes</div>
              <div class="feature"><i class="fas fa-check"></i> Basic Messaging</div>
              <div class="feature"><i class="fas fa-check"></i> Profile Visibility</div>
              <div class="feature"><i class="fas fa-times"></i> Voice/Video Calls</div>
            </div>
            <button class="subscribe-btn" onclick="selectPlan('Basic Access', 1500)">Subscribe</button>
          </div>
          
          <div class="plan-card featured">
            <div class="plan-title">Premium Access</div>
            <div class="plan-price">â‚¦2,500/month</div>
            <div class="plan-features">
              <div class="feature"><i class="fas fa-check"></i> Unlimited Swipes</div>
              <div class="feature"><i class="fas fa-check"></i> Unlimited Messages</div>
              <div class="feature"><i class="fas fa-check"></i> Voice Calls</div>
              <div class="feature"><i class="fas fa-check"></i> Video Calls</div>
              <div class="feature"><i class="fas fa-check"></i> Priority Matching</div>
            </div>
            <button class="subscribe-btn" onclick="selectPlan('Premium Access', 2500)">Subscribe</button>
          </div>
          
          <div class="plan-card">
            <div class="plan-title">VIP Access</div>
            <div class="plan-price">â‚¦5,000/month</div>
            <div class="plan-features">
              <div class="feature"><i class="fas fa-check"></i> All Premium Features</div>
              <div class="feature"><i class="fas fa-check"></i> VIP Profile Badge</div>
              <div class="feature"><i class="fas fa-check"></i> Dedicated Support</div>
              <div class="feature"><i class="fas fa-check"></i> Advanced Matching</div>
              <div class="feature"><i class="fas fa-check"></i> Profile Boosts</div>
            </div>
            <button class="subscribe-btn" onclick="selectPlan('VIP Access', 5000)">Subscribe</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Notification Area -->
  <div id="notificationArea"></div>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
  <script>
    // App State
    let currentUser = null;
    let userProfile = null;
    let userProfiles = [];
    let currentProfile = null;
    let selectedPlan = null;
    let selectedAmount = 0;

    // Usage Limits
    let usage = {
      messages: 2,
      voiceCalls: 2,
      videoCalls: 2
    };

    // ZegoCloud Configuration
    const ZEGO_APP_ID = 2061330765;
    const ZEGO_SERVER_SECRET = '0e85c5a1f2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f7g8h9i0j1k2l3m4n5o6p7q8r9s0t1u2v3w4x5y6z7';
    let zg = null;
    let localStream = null;
    let remoteStream = null;

    // PeerJS for WebRTC
    let peer = null;
    let currentCall = null;

    // Initialize app
    document.addEventListener('DOMContentLoaded', function() {
      checkAuthStatus();
      initializeInterests();
      loadSampleProfiles();
      
      // Add enter key listeners
      document.getElementById('login-password').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') login();
      });
      
      document.getElementById('confirm-password').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') signup();
      });

      document.getElementById('chat-input').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') sendChatMessage();
      });
    });

    function initializeInterests() {
      document.querySelectorAll('.interest-tag').forEach(tag => {
        tag.addEventListener('click', function() {
          this.classList.toggle('selected');
        });
      });
    }

    function loadSampleProfiles() {
      userProfiles = [
        {
          id: 1,
          name: 'Chiamaka Okoro',
          age: 25,
          location: 'Lagos, Nigeria',
          income: 'â‚¦1.5M - â‚¦3M',
          occupation: 'Fashion Designer',
          bio: 'Creative fashion designer with a passion for African prints. Love exploring new cultures and making meaningful connections.',
          interests: ['Fashion', 'Travel', 'Music', 'Art'],
          photos: ['https://images.unsplash.com/photo-1589156191108-c762ff4b96ab?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80']
        },
        {
          id: 2,
          name: 'Adebayo Johnson',
          age: 28,
          location: 'Abuja, Nigeria',
          income: 'â‚¦3M - â‚¦6M',
          occupation: 'Software Engineer',
          bio: 'Tech enthusiast who loves building innovative solutions. Enjoy watching football and exploring new music genres.',
          interests: ['Technology', 'Football', 'Music', 'Travel'],
          photos: ['https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80']
        },
        {
          id: 3,
          name: 'Jennifer Smith',
          age: 27,
          location: 'London, UK',
          income: 'â‚¦6M - â‚¦15M',
          occupation: 'Graphic Designer',
          bio: 'Creative soul who finds inspiration in everyday life. Looking for someone who appreciates art and good conversation.',
          interests: ['Art', 'Music', 'Cooking', 'Travel'],
          photos: ['https://images.unsplash.com/photo-1438761681033-6461ffad8d80?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80']
        }
      ];
    }

    // Authentication Functions
    function checkAuthStatus() {
      const savedUser = localStorage.getItem('soultide_user');
      const savedProfile = localStorage.getItem('soultide_profile');
      
      if (savedUser) {
        currentUser = JSON.parse(savedUser);
        if (savedProfile) {
          userProfile = JSON.parse(savedProfile);
          showPage('swipe');
        } else {
          showPage('profile-setup');
        }
        updateHeader();
      } else {
        showPage('auth');
      }
      updateUsageDisplay();
    }

    function showAuthTab(tab) {
      document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));
      
      event.target.classList.add('active');
      document.getElementById(tab + '-form').classList.add('active');
      
      clearAuthMessages();
    }

    function clearAuthMessages() {
      document.getElementById('login-error').style.display = 'none';
      document.getElementById('login-success').style.display = 'none';
      document.getElementById('signup-error').style.display = 'none';
      document.getElementById('signup-success').style.display = 'none';
    }

    function login() {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      const errorDiv = document.getElementById('login-error');
      const successDiv = document.getElementById('login-success');

      if (!email || !password) {
        errorDiv.textContent = 'Please fill in all fields';
        errorDiv.style.display = 'block';
        return;
      }

      // Show loading state
      const loginBtn = document.querySelector('#login-form .btn');
      const originalText = loginBtn.textContent;
      loginBtn.innerHTML = '<div class="spinner" style="width:20px;height:20px;margin:0 auto;"></div>';
      loginBtn.disabled = true;

      // Simulate API call
      setTimeout(() => {
        currentUser = {
          id: 'user-' + Math.random().toString(36).substr(2, 9),
          email: email,
          name: email.split('@')[0]
        };
        
        localStorage.setItem('soultide_user', JSON.stringify(currentUser));
        
        successDiv.textContent = 'Login successful!';
        successDiv.style.display = 'block';

        // Restore button
        loginBtn.textContent = originalText;
        loginBtn.disabled = false;

        setTimeout(() => {
          const savedProfile = localStorage.getItem('soultide_profile');
          if (savedProfile) {
            userProfile = JSON.parse(savedProfile);
            showPage('swipe');
          } else {
            showPage('profile-setup');
          }
          updateHeader();
        }, 1000);
      }, 1500);
    }

    function signup() {
      const email = document.getElementById('signup-email').value;
      const password = document.getElementById('signup-password').value;
      const confirmPassword = document.getElementById('confirm-password').value;
      const errorDiv = document.getElementById('signup-error');
      const successDiv = document.getElementById('signup-success');

      if (!email || !password || !confirmPassword) {
        errorDiv.textContent = 'Please fill in all fields';
        errorDiv.style.display = 'block';
        return;
      }

      if (password !== confirmPassword) {
        errorDiv.textContent = 'Passwords do not match';
        errorDiv.style.display = 'block';
        return;
      }

      // Show loading state
      const signupBtn = document.querySelector('#signup-form .btn');
      const originalText = signupBtn.textContent;
      signupBtn.innerHTML = '<div class="spinner" style="width:20px;height:20px;margin:0 auto;"></div>';
      signupBtn.disabled = true;

      // Simulate API call
      setTimeout(() => {
        currentUser = {
          id: 'user-' + Math.random().toString(36).substr(2, 9),
          email: email,
          name: email.split('@')[0]
        };
        
        localStorage.setItem('soultide_user', JSON.stringify(currentUser));
        
        successDiv.textContent = 'Account created successfully!';
        successDiv.style.display = 'block';

        // Restore button
        signupBtn.textContent = originalText;
        signupBtn.disabled = false;

        setTimeout(() => {
          showPage('profile-setup');
          updateHeader();
        }, 1000);
      }, 1500);
    }

    function logout() {
      currentUser = null;
      userProfile = null;
      localStorage.removeItem('soultide_user');
      localStorage.removeItem('soultide_profile');
      showPage('auth');
      document.getElementById('header-buttons').style.display = 'none';
      showNotification('You have been logged out successfully', 'success');
    }

    function updateHeader() {
      document.getElementById('header-buttons').style.display = 'flex';
    }

    // Profile Setup
    function handlePhotoUpload(input, index) {
      const file = input.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => {
          const placeholder = document.querySelectorAll('.photo-placeholder')[index-1];
          placeholder.innerHTML = `<img src="${e.target.result}" alt="Uploaded photo">`;
        };
        reader.readAsDataURL(file);
      }
    }

    function saveProfile() {
      const fullName = document.getElementById('profile-fullname').value;
      const age = document.getElementById('profile-age').value;
      const gender = document.getElementById('profile-gender').value;
      const income = document.getElementById('profile-income').value;
      const location = document.getElementById('profile-location').value;
      const bio = document.getElementById('profile-bio').value;
      const errorDiv = document.getElementById('profile-error');
      const successDiv = document.getElementById('profile-success');

      if (!fullName || !age || !gender || !income || !location) {
        errorDiv.textContent = 'Please fill in all required fields';
        errorDiv.style.display = 'block';
        return;
      }

      // Show loading state
      const saveBtn = document.querySelector('#profile-setup-page .btn');
      const originalText = saveBtn.textContent;
      saveBtn.innerHTML = '<div class="spinner" style="width:20px;height:20px;margin:0 auto;"></div>';
      saveBtn.disabled = true;

      const interests = Array.from(document.querySelectorAll('.interest-tag.selected')).map(t => t.textContent);
      const photos = [];
      document.querySelectorAll('.photo-placeholder img').forEach(img => {
        if (img.src && !img.src.includes('data:')) photos.push(img.src);
      });

      userProfile = {
        id: currentUser.id,
        fullName,
        age: parseInt(age),
        gender,
        income,
        location,
        bio,
        interests,
        photos: photos.length > 0 ? photos : ['https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80']
      };

      localStorage.setItem('soultide_profile', JSON.stringify(userProfile));
      
      // Restore button
      saveBtn.textContent = originalText;
      saveBtn.disabled = false;
      
      successDiv.textContent = 'Profile saved successfully!';
      successDiv.style.display = 'block';

      setTimeout(() => {
        showPage('swipe');
        loadNextProfile();
      }, 1000);
    }

    function skipProfileSetup() {
      // Create a minimal profile
      userProfile = {
        id: currentUser.id,
        fullName: currentUser.name,
        age: 25,
        gender: 'other',
        income: '0-500k',
        location: 'Nigeria',
        bio: 'New to SoulTide!',
        interests: [],
        photos: ['https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-4.0.3&auto=format&fit=crop&w=400&q=80']
      };

      localStorage.setItem('soultide_profile', JSON.stringify(userProfile));
      showPage('swipe');
      loadNextProfile();
    }

    // Swiping Functions
    function loadNextProfile() {
      if (userProfiles.length === 0) {
        document.getElementById('profile-card').innerHTML = '<p style="text-align:center;padding:40px;">No more profiles available.</p>';
        return;
      }
      
      const profile = userProfiles[0]; // Get first profile
      userProfiles = userProfiles.slice(1); // Remove from array
      
      const photo = profile.photos[0];
      document.getElementById('profile-card').innerHTML = `
        <div class="profile-image" style="background-image: url('${photo}')"></div>
        <div class="profile-info">
          <div class="profile-name">${profile.name}, ${profile.age}</div>
          <div class="profile-age">${profile.location} â€¢ ${profile.income}</div>
          <div class="profile-bio">${profile.bio}</div>
          <div class="profile-interests">
            ${profile.interests.map(i => `<span class="interest-tag">${i}</span>`).join('')}
          </div>
        </div>
        <div class="swipe-actions">
          <button class="swipe-btn pass-btn" onclick="swipe('pass')">âœ•</button>
          <button class="swipe-btn like-btn" onclick="swipe('like', '${profile.id}')">â™¥</button>
        </div>
      `;
      
      currentProfile = profile;
    }

    function swipe(action, profileId) {
      if (action === 'like') {
        showNotification('You liked this profile!', 'success');
        // In a real app, you'd send this to your backend
      } else {
        showNotification('Profile passed', 'success');
      }
      
      setTimeout(() => {
        if (userProfiles.length > 0) {
          loadNextProfile();
        } else {
          document.getElementById('profile-card').innerHTML = `
            <div style="text-align:center;padding:40px;">
              <h3>No more profiles!</h3>
              <p>Check back later for new matches.</p>
              <button class="btn" onclick="loadSampleProfiles(); loadNextProfile();" style="margin-top:20px;">
                Reload Profiles
              </button>
            </div>
          `;
        }
      }, 500);
    }

    // Profile Detail Functions
    function showProfileDetail(profileId) {
      const profile = userProfiles.find(p => p.id == profileId) || currentProfile;
      if (!profile) return;
      
      document.getElementById('detail-profile-pic').src = profile.photos[0];
      document.getElementById('detail-name').textContent = `${profile.name}, ${profile.age}`;
      document.getElementById('detail-location').textContent = profile.location;
      document.getElementById('detail-age').textContent = profile.age;
      document.getElementById('detail-income').textContent = profile.income;
      document.getElementById('detail-occupation').textContent = profile.occupation;
      document.getElementById('detail-interests').textContent = profile.interests.join(', ');
      document.getElementById('detail-bio').textContent = profile.bio;
      
      currentProfile = profile;
      showPage('profile-detail');
    }

    // Communication Functions
    function startChat() {
      if (usage.messages <= 0) {
        showNotification('Please subscribe to send more messages', 'error');
        showPage('subscription');
        return;
      }
      
      document.getElementById('chat-user-avatar').style.backgroundImage = `url('${currentProfile.photos[0]}')`;
      document.getElementById('chat-user-name').textContent = currentProfile.name;
      document.getElementById('chat-messages').innerHTML = '<div class="no-messages">Start a conversation!</div>';
      showPage('chat');
    }

    function sendChatMessage() {
      const input = document.getElementById('chat-input');
      const message = input.value.trim();
      
      if (!message) return;
      
      if (usage.messages <= 0) {
        showNotification('Please subscribe to send more messages', 'error');
        return;
      }
      
      // Deduct message count
      usage.messages--;
      updateUsageDisplay();
      
      const messagesContainer = document.getElementById('chat-messages');
      const messageDiv = document.createElement('div');
      messageDiv.className = 'message sent';
      messageDiv.textContent = message;
      messagesContainer.appendChild(messageDiv);
      
      input.value = '';
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
      
      // Simulate reply
      setTimeout(() => {
        const replies = [
          "That's interesting! Tell me more about yourself.",
          "I'd love to get to know you better!",
          "That sounds amazing! What else do you enjoy?",
          "I feel like we have a lot in common!",
          "You seem really interesting! ðŸ˜Š"
        ];
        const reply = replies[Math.floor(Math.random() * replies.length)];
        
        const replyDiv = document.createElement('div');
        replyDiv.className = 'message received';
        replyDiv.textContent = reply;
        messagesContainer.appendChild(replyDiv);
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
      }, 1000 + Math.random() * 2000);
    }

    function startVoiceCall() {
      if (usage.voiceCalls <= 0) {
        showNotification('Please subscribe to make voice calls', 'error');
        showPage('subscription');
        return;
      }
      
      usage.voiceCalls--;
      updateUsageDisplay();
      showNotification('Starting voice call...', 'success');
      // Initialize voice call
      initializeCall(false);
    }

    function startVideoCall() {
      if (usage.videoCalls <= 0) {
        showNotification('Please subscribe to make video calls', 'error');
        showPage('subscription');
        return;
      }
      
      usage.videoCalls--;
      updateUsageDisplay();
      showNotification('Starting video call...', 'success');
      // Initialize video call
      initializeCall(true);
    }

    // ZegoCloud Call Functions
    async function initializeCall(withVideo = true) {
      try {
        if (!zg) {
          zg = new ZegoExpressEngine(ZEGO_APP_ID, ZEGO_SERVER_SECRET);
        }

        // Login room
        await zg.loginRoom('soultide_room', ZegoRTC.UserID, { userName: currentUser.name });
        
        // Create and publish stream
        localStream = await zg.createStream({
          camera: {
            audio: true,
            video: withVideo
          }
        });
        
        const localVideo = document.getElementById('local-video');
        if (localVideo) {
          localVideo.srcObject = localStream;
        }
        
        await zg.startPublishingStream('local_stream', localStream);
        
        // Listen for remote streams
        zg.on('publisherStateUpdate', (result) => {
          console.log('Publisher State Update:', result);
        });
        
        zg.on('playerStateUpdate', (result) => {
          console.log('Player State Update:', result);
        });
        
        document.getElementById('call-status').textContent = 'Calling...';
        document.getElementById('call-ui').style.display = 'flex';
        
      } catch (error) {
        console.error('Call initialization failed:', error);
        showNotification('Failed to start call. Please try again.', 'error');
      }
    }

    function endCall() {
      if (zg) {
        zg.stopPublishingStream('local_stream');
        zg.logoutRoom('soultide_room');
      }
      if (localStream) {
        localStream.getTracks().forEach(track => track.stop());
        localStream = null;
      }
      document.getElementById('call-ui').style.display = 'none';
    }

    function answerCall() {
      // Implement call answering logic
      document.getElementById('answer-btn').style.display = 'none';
      document.getElementById('reject-btn').style.display = 'none';
      document.getElementById('call-status').textContent = 'Connected';
    }

    function rejectCall() {
      endCall();
    }

    // Subscription Functions
    function selectPlan(plan, amount) {
      selectedPlan = plan;
      selectedAmount = amount;
      
      document.getElementById('selected-plan').textContent = plan;
      document.getElementById('selected-amount').textContent = `â‚¦${amount.toLocaleString()}`;
      document.getElementById('paymentModal').style.display = 'flex';
    }

    function closeModal(modalId) {
      document.getElementById(modalId).style.display = 'none';
    }

    function processPayment() {
      if (!currentUser || !currentUser.email) {
        showNotification('Please login to continue', 'error');
        return;
      }

      const handler = PaystackPop.setup({
        key: 'pk_live_669ad09183f1ded9229c99297d5d67f539e3c828', // Your Paystack public key
        email: currentUser.email,
        amount: selectedAmount * 100,
        currency: 'NGN',
        ref: 'ST' + Math.floor((Math.random() * 1000000000) + 1),
        callback: function(response) {
          showNotification('Payment successful! Subscription activated.', 'success');
          closeModal('paymentModal');
          
          // Reset usage limits for subscribed users
          usage.messages = Infinity;
          usage.voiceCalls = Infinity;
          usage.videoCalls = Infinity;
          updateUsageDisplay();
          
          // Store subscription status
          localStorage.setItem('soultide_subscription', JSON.stringify({
            plan: selectedPlan,
            amount: selectedAmount,
            paidAt: new Date().toISOString()
          }));
        },
        onClose: function() {
          showNotification('Payment cancelled', 'error');
        }
      });
      handler.openIframe();
    }

    function updateUsageDisplay() {
      document.getElementById('message-count').textContent = 
        usage.messages === Infinity ? 'Unlimited' : usage.messages;
      document.getElementById('voice-call-count').textContent = 
        usage.voiceCalls === Infinity ? 'Unlimited' : usage.voiceCalls;
      document.getElementById('video-call-count').textContent = 
        usage.videoCalls === Infinity ? 'Unlimited' : usage.videoCalls;
      
      const warning = document.getElementById('usage-warning');
      if (usage.messages === Infinity) {
        warning.style.display = 'none';
      } else {
        warning.style.display = 'block';
      }
    }

    // Utility Functions
    function showPage(pageName) {
      document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
      document.getElementById(pageName + '-page').classList.add('active');
      
      if (pageName === 'swipe' && userProfile) {
        loadNextProfile();
      }
    }

    function showNotification(message, type = 'success') {
      const notificationArea = document.getElementById('notificationArea');
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      notificationArea.appendChild(notification);
      
      setTimeout(() => {
        notification.classList.add('show');
      }, 100);
      
      setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => {
          notificationArea.removeChild(notification);
        }, 300);
      }, 3000);
    }

    // Initialize ZegoCloud
    async function initializeZegoCloud() {
      if (!zg) {
        zg = new ZegoExpressEngine(ZEGO_APP_ID, ZEGO_SERVER_SECRET);
        // Additional initialization can be done here
      }
    }

    // Initialize the app
    initializeZegoCloud();
  </script>
</body>
</html>
